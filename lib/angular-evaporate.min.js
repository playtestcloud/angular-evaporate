!function(e){"use strict";angular.module("evaporate",[]).provider("eva",function(){var t;this.config=function(e){t=e},this.$get=[function(){return{_:new e(t),urlBase:"http://"+t.bucket+".s3.amazonaws.com/"}}]}).directive("evaporate",["eva",function(e){function t(t,n){function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}function r(){}function o(e,t){for(var n=e.length,a=0;n>a;a++)if(angular.equals(e[a],t))return a;return-1}t.data||(t.data={});var i=t.data,c=i.dir?i.dir+"/":"",l=i.timestampSeparator||"$",s=i.headersCommon||{},u=i.headersSigned||{},f="function"==typeof i.onFileProgress?i.onFileProgress:r,p="function"==typeof i.onFileComplete?i.onFileComplete:r,d="function"==typeof i.onFileError?i.onFileError:r,x="function"==typeof i.onFileCancelled?i.onFileCancelled:r;i.ready=!1,e._.supported&&(n.bind("change",function(r){i.files=[],angular.forEach(r.target.files,function(n){var r=t.obfuscateName?a():n.name;n.started=Date.now(),n.path_=c+n.started+l+r,n.url=e.urlBase+n.path_;var m=e._.add({name:n.path_,file:n,contentType:n.type||"binary/octet-stream",notSignedHeadersAtInitiate:s,xAmzHeadersAtInitiate:u,complete:function(){n.completed=!0,p(n),t.$apply()},progress:function(e){n.progress=Math.round(1e4*e)/100,n.timeLeft=Math.round((100-n.progress)/n.progress*(Date.now()-n.started)/1e3),f(n),t.$apply()},error:function(e){var a=o(i.files,n);-1!==a&&i.files.splice(a,1),d(n,e),t.$apply()},cancelled:function(){n.cancelled=!0,x(n)}});n.cancel=function(){e._.cancel(m)},i.files.push(n)}),n.wrap("<form>").closest("form").get(0).reset(),n.unwrap(),t.$apply()}),i.ready=!0)}return{restrict:"A",link:t,scope:{data:"=evaModel",obfuscateName:"=evaObfuscate"}}}])}(Evaporate);